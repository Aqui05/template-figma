<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sélection d'idoles</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <link rel="stylesheet" href="style/styles_derniere_etape.css" />
  </head>

  <body>
    <div class="container">
      <div class="header">
        <h1>Dernière étape ! </h1>
        <button id="passer" class="close-btn">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="14"
            height="14"
            viewBox="0 0 14 14"
            fill="none"
          >
            <path
              d="M14 1.41L12.59 0L7 5.59L1.41 0L0 1.41L5.59 7L0 12.59L1.41 14L7 8.41L12.59 14L14 12.59L8.41 7L14 1.41Z"
              fill="#C4C4C4"
            />
          </svg>
        </button>
      </div>
      <p class="subtitle">Suivez 10 de vos idoles préférées ou plus</p>
      <div class="carousel-container">
        <div class="carousel">
          <div class="card active">
            <img src="./assets/img8.jfif" alt="Sessimin" />
            <div class="card-content">
              <div class="titre">
                <h2>Sessimin</h2>
                <p>Artiste musicien</p>
                <span>20576 Abonnés • 400 Videos</span>
              </div>
              <button class="follow-btn" onclick="window.location.href='#'">
                <span>Suivre</span>
              </button>
            </div>
          </div>
          <div class="card">
            <img src="./assets/img4.jfif" alt="Artiste 2" />
            <div class="card-content">
              <div class="titre">
                <h2>Artiste 2</h2>
                <p>Chanteur</p>
                <span>15000 Abonnés • 250 Videos</span>
              </div>
              <button class="follow-btn" onclick="window.location.href='#'">
                <span>Suivre</span>
              </button>
            </div>
          </div>
          <div class="card">
            <img src="./assets/img4_2.jfif" alt="Artiste 3" />
            <div class="card-content">
              <div class="titre">
                <h2>Artiste 3</h2>
                <p>Producteur</p>
                <span>30000 Abonnés • 150 Videos</span>
              </div>
              <button class="follow-btn" onclick="window.location.href='#'">
                <span>Suivre</span>
              </button>
            </div>
          </div>
        </div>
      </div>
      <footer>
        <!-- Bouton Continuer avec redirection -->
        <button type="submit" id="continuer" class="submit-button">
          <span>Continuer</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="18"
            height="12"
            viewBox="0 0 18 12"
            fill="none"
          >
            <path
              d="M0 5H14.17L10.59 1.41L12 0L18 6L12 12L10.59 10.59L14.17 7H0V5Z"
              fill="white"
            />
          </svg>
        </button>
      </footer>
    </div>

    <script>
      function redirectTo(url) {
        window.location.href = url;
      }

      document
        .getElementById("continuer")
        .addEventListener("click", function () {
          redirectTo("./newsfeed.html#slide1");
        });

      document.getElementById("passer").addEventListener("click", function () {
        redirectTo("./newsfeed.html#slide1");
      });
      
    
// Sélectionnez les éléments du DOM
const carousel = document.querySelector('.carousel');
const cards = document.querySelectorAll('.card');
const totalCards = cards.length;

let currentIndex = 0;
let isScrolling = false;
let scrollTimeout;

// Fonction pour mettre à jour la carte active
function updateActiveCard() {
  cards.forEach((card, index) => {
    card.classList.remove('active');
    if (index === currentIndex) {
      card.classList.add('active');
    }
  });
}

// Fonction pour déterminer quelle carte est la plus visible
function getMostVisibleCard() {
  let maxVisibility = 0;
  let mostVisibleIndex = 0;

  cards.forEach((card, index) => {
    const rect = card.getBoundingClientRect();
    const visibility = Math.min(rect.right, carousel.clientWidth) - Math.max(rect.left, 0);

    if (visibility > maxVisibility) {
      maxVisibility = visibility;
      mostVisibleIndex = index;
    }
  });

  return mostVisibleIndex;
}

// Gestionnaire d'événements pour le défilement
carousel.addEventListener('scroll', () => {
  if (!isScrolling) {
    isScrolling = true;
    carousel.classList.add('is-scrolling');
  }

  clearTimeout(scrollTimeout);

  scrollTimeout = setTimeout(() => {
    isScrolling = false;
    carousel.classList.remove('is-scrolling');
    currentIndex = getMostVisibleCard();
    updateActiveCard();
  }, 150); // Délai avant de considérer que le défilement est terminé
});

// Fonction pour faire défiler automatiquement le carrousel
function scrollCarousel() {
  if (!isScrolling) {
    currentIndex = (currentIndex + 1) % totalCards;
    cards[currentIndex].scrollIntoView({
      behavior: 'smooth',
      inline: 'center'
    });
    updateActiveCard();
  }
}

// Démarrer le défilement automatique
let autoScrollInterval = setInterval(scrollCarousel, 3000);

// Arrêter le défilement automatique lorsque l'utilisateur interagit avec le carrousel
carousel.addEventListener('mouseenter', () => {
  clearInterval(autoScrollInterval);
});

// Reprendre le défilement automatique lorsque l'utilisateur cesse d'interagir
carousel.addEventListener('mouseleave', () => {
  autoScrollInterval = setInterval(scrollCarousel, 3000);
});

// Initialisation
updateActiveCard();
    </script>
  </body>
</html>
